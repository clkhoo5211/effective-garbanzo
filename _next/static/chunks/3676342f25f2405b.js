(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72412,88653,e=>{"use strict";var t=e.i(43476),r=e.i(932),s=e.i(71645),l=e.i(74080);e.i(47167);var n=e.i(31178),a=e.i(47414),i=e.i(74008),o=e.i(21476),c=e.i(72846),d=s,u=e.i(37806);function m(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class x extends d.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,c.isHTMLElement)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function f({children:e,isPresent:r,anchorX:l,root:n}){let a=(0,d.useId)(),i=(0,d.useRef)(null),o=(0,d.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=(0,d.useContext)(u.MotionConfigContext),f=function(...e){return s.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=m(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():m(e[t],null)}}}}(...e),e)}(i,e?.ref);return(0,d.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:d,right:u}=o.current;if(r||!i.current||!e||!t)return;let m="left"===l?`left: ${d}`:`right: ${u}`;i.current.dataset.motionPopId=a;let x=document.createElement("style");c&&(x.nonce=c);let f=n??document.head;return f.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${m}px !important;
            top: ${s}px !important;
          }
        `),()=>{f.contains(x)&&f.removeChild(x)}},[r]),(0,t.jsx)(x,{isPresent:r,childRef:i,sizeRef:o,children:d.cloneElement(e,{ref:f})})}let p=({children:e,initial:r,isPresent:l,onExitComplete:n,custom:i,presenceAffectsLayout:c,mode:d,anchorX:u,root:m})=>{let x=(0,a.useConstant)(h),p=(0,s.useId)(),v=!0,b=(0,s.useMemo)(()=>(v=!1,{id:p,initial:r,isPresent:l,custom:i,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;n&&n()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[l,x,n]);return c&&v&&(b={...b}),(0,s.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[l]),s.useEffect(()=>{l||x.size||!n||n()},[l]),"popLayout"===d&&(e=(0,t.jsx)(f,{isPresent:l,anchorX:u,root:m,children:e})),(0,t.jsx)(o.PresenceContext.Provider,{value:b,children:e})};function h(){return new Map}var v=e.i(64978);let b=e=>e.key||"";function g(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let j=({children:e,custom:r,initial:l=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:m="left",root:x})=>{let[f,h]=(0,v.usePresence)(u),j=(0,s.useMemo)(()=>g(e),[e]),y=u&&!f?[]:j.map(b),w=(0,s.useRef)(!0),N=(0,s.useRef)(j),C=(0,a.useConstant)(()=>new Map),[k,E]=(0,s.useState)(j),[L,R]=(0,s.useState)(j);(0,i.useIsomorphicLayoutEffect)(()=>{w.current=!1,N.current=j;for(let e=0;e<L.length;e++){let t=b(L[e]);y.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[L,y.length,y.join("-")]);let P=[];if(j!==k){let e=[...j];for(let t=0;t<L.length;t++){let r=L[t],s=b(r);y.includes(s)||(e.splice(t,0,r),P.push(r))}return"wait"===d&&P.length&&(e=P),R(g(e)),E(j),null}let{forceRender:U}=(0,s.useContext)(n.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:L.map(e=>{let s=b(e),n=(!u||!!f)&&(j===L||y.includes(s));return(0,t.jsx)(p,{isPresent:n,initial:(!w.current||!!l)&&void 0,custom:r,presenceAffectsLayout:c,mode:d,root:x,onExitComplete:n?void 0:()=>{if(!C.has(s))return;C.set(s,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(U?.(),R(N.current),u&&h?.(),o&&o())},anchorX:m,children:e},s)})})};e.s(["AnimatePresence",()=>j],88653);var y=e.i(46932),w=e.i(75157);function N(e){let n,a,i,o,c,d,u,m,x=(0,r.c)(19),{open:f,onClose:p,children:h,className:v,disableCloseOnOverlay:b,lockScroll:g,closeOnEsc:N}=e,k=void 0!==b&&b,E=void 0===g||g,L=void 0===N||N,[R,P]=(0,s.useState)(!1);return(x[0]===Symbol.for("react.memo_cache_sentinel")?(n=()=>{P(!0)},a=[],x[0]=n,x[1]=a):(n=x[0],a=x[1]),(0,s.useEffect)(n,a),x[2]!==E||x[3]!==f?(i=()=>{if(!E||!f)return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},o=[E,f],x[2]=E,x[3]=f,x[4]=i,x[5]=o):(i=x[4],o=x[5]),(0,s.useEffect)(i,o),x[6]!==L||x[7]!==p||x[8]!==f?(c=()=>{if(!L||!f)return;let e=e=>{"Escape"===e.key&&p()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},d=[L,p,f],x[6]=L,x[7]=p,x[8]=f,x[9]=c,x[10]=d):(c=x[9],d=x[10]),(0,s.useEffect)(c,d),R)?(x[11]!==h||x[12]!==v||x[13]!==k||x[14]!==p||x[15]!==f?(u=f&&(0,t.jsx)(y.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-white/40 p-4 backdrop-blur-xl",onClick:k?void 0:p,children:(0,t.jsx)(y.motion.div,{initial:{opacity:0,scale:.8,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:20},className:(0,w.cn)("static",v),onClick:C,children:h})}),x[11]=h,x[12]=v,x[13]=k,x[14]=p,x[15]=f,x[16]=u):u=x[16],x[17]!==u?(m=(0,l.createPortal)((0,t.jsx)(j,{children:u}),document.body),x[17]=u,x[18]=m):m=x[18],m):null}function C(e){return e.stopPropagation()}e.s(["DialogModal",()=>N],72412)},49793,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(46932),l=e.i(63580),n=e.i(72412);function a(e){return e<1024?`${e.toFixed(0)} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1024/1024).toFixed(2)} MB`}async function i(e,t,r){let s=await createImageBitmap(e),l=document.createElement("canvas"),n=s.width,a=s.height;if(r&&n>r){let e=r/n;n=r,a=Math.round(a*e)}l.width=n,l.height=a;let i=l.getContext("2d");if(!i)throw Error("æ— æ³•åˆå§‹åŒ–ç”»å¸ƒ");return i.drawImage(s,0,0,n,a),await new Promise((e,r)=>{l.toBlob(t=>{t?e(t):r(Error("æ— æ³•ç”Ÿæˆ WEBP æ–‡ä»¶"))},"image/webp",t)})}function o(){let[e,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(.8),[u,m]=(0,r.useState)(!1),[x,f]=(0,r.useState)(1200),[p,h]=(0,r.useState)(!1),[v,b]=(0,r.useState)(null),[g,j]=(0,r.useState)(!1),y=e.length>0,w=e.length>0,N=e.some(e=>!!e.converted),C=(0,r.useRef)([]),k=(0,r.useRef)(0);(0,r.useEffect)(()=>{C.current=e},[e]);let E=(0,r.useCallback)(async e=>{if(!e?.length)return;let t=Array.from(e).filter(e=>e.type.startsWith("image/"));if(!t.length)return;let r=await Promise.all(t.map(async e=>{let t=URL.createObjectURL(e),r=await createImageBitmap(e);return{file:e,preview:t,width:r.width,height:r.height}}));o(e=>{let t=[...e];return r.forEach(e=>{t.some(t=>t.file.name===e.file.name&&t.file.size===e.file.size&&t.file.lastModified===e.file.lastModified)?URL.revokeObjectURL(e.preview):t.push(e)}),t})},[]),L=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),k.current+=1,j(!0)},[]),R=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),P=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),k.current=Math.max(0,k.current-1),0===k.current&&j(!1)},[]),U=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),j(!1),k.current=0,E(e.dataTransfer?.files??null)},[E]),$=(0,r.useMemo)(()=>{let t=e.reduce((e,t)=>e+t.file.size,0);return t<1048576?`${(t/1024).toFixed(1)} KB`:`${(t/1024/1024).toFixed(2)} MB`},[e]),I=(0,r.useCallback)(async t=>{let r=e[t];if(r&&!r.converting){o(e=>e.map((e,r)=>r===t?{...e,converting:!0}:e));try{let e=await i(r.file,c,u?x:void 0),s=URL.createObjectURL(e);o(r=>r.map((r,l)=>l!==t?r:(r.converted?.url&&URL.revokeObjectURL(r.converted.url),{...r,converting:!1,converted:{url:s,size:e.size}})))}catch(e){console.error(e),alert("è½¬æ¢è¿‡ç¨‹ä¸­å‡ºçŽ°é—®é¢˜ï¼Œè¯·ç¨åŽå†è¯•"),o(e=>e.map((e,r)=>r===t?{...e,converting:!1}:e))}}},[e,c,u,x]),M=(0,r.useCallback)(t=>{let r=e[t];if(!r?.converted)return;let s=document.createElement("a"),l=r.file.name.replace(/\.[^.]+$/,"");s.href=r.converted.url,s.download=`${l}.webp`,document.body.appendChild(s),s.click(),s.remove()},[e]),O=(0,r.useCallback)(async()=>{if(y&&!p){h(!0);try{for(let e=0;e<C.current.length;e+=1){let t=C.current[e];if(!t)continue;o(t=>t.map((t,r)=>r===e?{...t,converting:!0}:t));let r=await i(t.file,c,u?x:void 0),s=URL.createObjectURL(r);o(t=>t.map((t,l)=>l!==e?t:(t.converted?.url&&URL.revokeObjectURL(t.converted.url),{...t,converting:!1,converted:{url:s,size:r.size}})))}}catch(e){console.error(e),alert("æ‰¹é‡è½¬æ¢è¿‡ç¨‹ä¸­å‡ºçŽ°é—®é¢˜ï¼Œè¯·ç¨åŽå†è¯•")}finally{h(!1)}}},[p,y,c,u,x]),D=(0,r.useCallback)(()=>{N&&e.forEach(e=>{if(!e.converted)return;let t=document.createElement("a"),r=e.file.name.replace(/\.[^.]+$/,"");t.href=e.converted.url,t.download=`${r}.webp`,document.body.appendChild(t),t.click(),t.remove()})},[e,N]),z=(0,r.useCallback)(e=>{o(t=>{let r=[...t],s=r.splice(e,1)[0];return s&&(URL.revokeObjectURL(s.preview),s.converted?.url&&URL.revokeObjectURL(s.converted.url)),r})},[]),A=(0,r.useCallback)(e=>{b(e)},[]),B=(0,r.useCallback)(()=>{b(null)},[]);return(0,r.useEffect)(()=>()=>{C.current.forEach(e=>{URL.revokeObjectURL(e.preview),e.converted?.url&&URL.revokeObjectURL(e.converted.url)})},[]),(0,t.jsxs)("div",{className:"relative px-6 pt-32 pb-12 text-sm max-sm:pt-28",children:[(0,t.jsxs)("div",{className:"mx-auto flex max-w-3xl flex-col gap-6",children:[(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:l.INIT_DELAY},className:"space-y-2 text-center",children:[(0,t.jsx)("p",{className:"text-secondary text-xs tracking-[0.2em] uppercase",children:"Image Toolbox"}),(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"PNG / JPG è½¬ WEBP"}),(0,t.jsx)("p",{className:"text-secondary",children:"é€‰æ‹©å›¾ç‰‡ â†’ è°ƒæ•´è´¨é‡ â†’ ä¸€é”®è½¬æ¢ä¸‹è½½"})]}),(0,t.jsxs)(s.motion.label,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:l.INIT_DELAY+l.ANIMATION_DELAY},onDragEnter:L,onDragOver:R,onDragLeave:P,onDrop:U,className:`group hover:border-brand/20 card relative flex cursor-pointer flex-col items-center justify-center gap-3 text-center transition-colors hover:bg-white/80 ${g?"border-brand bg-white":""}`,children:[(0,t.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:e=>E(e.target.files)}),(0,t.jsx)("div",{className:"bg-brand/10 text-brand/60 group-hover:bg-brand/10 flex h-20 w-20 items-center justify-center rounded-full text-3xl transition",children:"ðŸ“·"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-base font-medium",children:"ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡"}),(0,t.jsx)("p",{className:"text-secondary text-xs",children:"æ”¯æŒ PNGã€JPGã€JPEGã€HEIC ç­‰å¸¸è§æ ¼å¼"})]})]}),y&&(0,t.jsxs)(s.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"card relative",children:[(0,t.jsxs)("div",{className:"text-secondary flex items-center justify-between border-b border-slate-200 pb-3 text-xs tracking-[0.2em] uppercase",children:[(0,t.jsxs)("span",{children:["å·²é€‰æ‹© ",e.length," å¼ å›¾ç‰‡"]}),(0,t.jsx)("span",{children:$})]}),(0,t.jsx)("ul",{className:"divide-y divide-slate-200",children:e.map((e,r)=>{let{file:s,preview:l,converted:n,converting:i}=e;return(0,t.jsxs)("li",{className:"flex items-center gap-4 py-3",children:[(0,t.jsx)("div",{className:"h-12 w-12 overflow-hidden rounded-xl border border-slate-200 bg-slate-50",children:(0,t.jsx)("img",{src:l,alt:s.name,className:"h-full w-full object-cover"})}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,t.jsx)("p",{className:"font-medium",children:function(e){let t;if(e.length<=32)return e;let r=(t=e.lastIndexOf("."))>=0?e.slice(t):"";if(!r)return`${e.slice(0,29)}...`;let s=Math.max(1,32-r.length-3);return`${e.slice(0,s)}...${r}`}(s.name)}),(0,t.jsxs)("p",{className:"text-secondary text-xs",children:[e.width," Ã— ",e.height," Â· ",a(s.size),n?`ï¼ˆè½¬æ¢åŽ ${a(n.size)}ï¼‰`:""]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-end gap-2 text-xs",children:[(0,t.jsx)("button",{onClick:()=>I(r),disabled:!!i,className:"rounded-full px-3 py-1 font-medium transition disabled:cursor-not-allowed disabled:text-slate-300",children:i?"è½¬æ¢ä¸­...":n?"é‡æ–°è½¬æ¢":"è½¬æ¢"}),n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>A(r),className:"border-brand text-brand hover:bg-brand/10 rounded-full border px-3 py-1 font-semibold transition",children:"å¯¹æ¯”"}),(0,t.jsx)("button",{onClick:()=>M(r),className:"border-brand text-brand hover:bg-brand/10 rounded-full border px-3 py-1 font-semibold transition",children:"ä¸‹è½½"})]}):null,(0,t.jsx)("button",{onClick:()=>z(r),className:"rounded-full border border-red-200 px-3 py-1 font-medium text-rose-400 transition hover:bg-rose-50",children:"ç§»é™¤"})]})]},`${s.name}-${r}`)})})]}),(0,t.jsx)(s.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:l.INIT_DELAY+2*l.ANIMATION_DELAY},className:"card relative",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-secondary text-xs tracking-[0.2em] uppercase",children:"è´¨é‡"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 pt-2",children:[(0,t.jsx)("input",{type:"range",min:.3,max:1,step:.05,value:c,onChange:e=>d(parseFloat(e.target.value)),className:"range-track"}),(0,t.jsxs)("span",{className:"w-12 text-right text-sm font-medium",children:[Math.round(100*c),"%"]})]}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["ä½¿ç”¨ canvas.toDataURL('image/webp', ",c.toFixed(2),")"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"limit-max-width",checked:u,onChange:e=>m(e.target.checked),className:"h-4 w-4 rounded border-slate-300"}),(0,t.jsx)("label",{htmlFor:"limit-max-width",className:"text-secondary cursor-pointer text-xs tracking-[0.2em] uppercase",children:"é™åˆ¶æœ€å¤§å®½åº¦"})]}),u&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"number",min:100,max:1e4,step:100,value:x,onChange:e=>f(Math.max(100,parseInt(e.target.value)||1200)),className:"w-24 rounded border border-slate-200 px-2 py-1 text-sm"}),(0,t.jsx)("span",{className:"text-xs text-slate-500",children:"px"})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 text-sm",children:[(0,t.jsx)("button",{onClick:O,disabled:!w||p,className:"rounded-full border border-slate-200 px-4 py-2 font-medium transition disabled:cursor-not-allowed disabled:border-slate-200 disabled:text-slate-300",children:p?"å…¨éƒ¨è½¬æ¢ä¸­â€¦":"å…¨éƒ¨è½¬æ¢"}),(0,t.jsx)("button",{onClick:D,disabled:!N,className:"border-brand text-brand rounded-full border px-4 py-2 font-semibold transition disabled:cursor-not-allowed disabled:border-slate-200 disabled:text-slate-300",children:"å…¨éƒ¨ä¸‹è½½"})]})]})})]}),null!==v&&e[v]?.converted&&(0,t.jsx)(n.DialogModal,{open:!0,onClose:B,className:"w-full",children:(0,t.jsxs)("div",{className:"grid w-full grid-cols-2 gap-4",onClick:B,children:[(0,t.jsx)("div",{className:"flex flex-col items-end p-4",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-secondary text-center text-sm font-medium",children:["åŽŸå›¾ (",a(e[v].file.size),")"]}),(0,t.jsx)("img",{src:e[v].preview,alt:"Original",className:"mt-3 max-h-[90vh] rounded-xl bg-slate-100"})]})}),(0,t.jsx)("div",{className:"flex flex-col items-start p-4",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-secondary text-center text-sm font-medium",children:["WEBP (",a(e[v].converted.size),")"]}),(0,t.jsx)("img",{src:e[v].converted.url,alt:"Converted",className:"mt-3 max-h-[90vh] rounded-xl bg-slate-100"})]})})]})})]})}e.s(["default",()=>o])}]);